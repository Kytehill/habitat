{% extends "navigation.html" %}

{% block app_content %}
<h1>{{ user.username }}'s Environments</h1>
<table class="table" style="width:100%">
<form action="" method="post">
    {{ form.hidden_tag() }}
    <tr>
    <td class="form-group">
        {{ form.name.label }}<br>
        {{ form.name(size=32) }}<br>
        {% for error in form.name.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </td>
    <td class="form-group">
        {{ form.timing.label }}<br>
        {{ form.timing(size=64) }}<br>
        {% for error in form.timing.errors %}
        <span style="color: red;">[{{ error }}]</span>
        {% endfor %}
    </td>
    </tr>
    <tr><td class="form-group">{{ form.submit() }}</td><td></td></tr>
</form>
</table>
<table class="table" style="width:100%">
    <tr>
        <th>Environment Name</th>
        <th>Environment Status</th>
        <th>Environment Timing</th>
        <th>Environment Approval Status</th>
        <th>Environment Status</th>
        <th></th>
        <th></th>
        <th></th>
    </tr>
    {% for environment in environments %}
    <tr>
        <td>{{ environment.name }}</td>
        <td>{{ environment.env_status }}</td>
        <td>{{ environment.timing }}</td>
        <td>{{ environment.approval_status }}</td>
        {% if environment.env_status == 2 %}
        <td style="background-color:green">PASS</td>
        {% elif environment.env_status == 1 %}
        <td style="background-color:orange">INVESTIGATION ONGOING</td>
        {% else %}
        <td style="background-color:red">FAIL</td>
        {% endif %}
        <td><a href="{{ url_for('edit_environment', env_id= environment.id ) }}">Edit Environment</a></td>
        <td><a href="{{ url_for('delete_environment', env_id= environment.id ) }}">Delete Environment</a></td>
        <td><a href="{{ url_for('servers', env_id_fk= environment.id ) }}">Servers in {{ environment.name }}</a></td>
    </tr>
    {% endfor %}
</table>
{% endblock %}